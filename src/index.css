@import 'katex/dist/katex.min.css';

@import "katex/dist/katex.min.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

/* JEE Learning App Design System - Educational theme with blues and purples */

@layer base {
  :root {
    /* Educational Blue-Purple Theme */
    --background: 240 10% 98%;
    --foreground: 230 15% 15%;

    --card: 0 0% 100%;
    --card-foreground: 230 15% 15%;

    --popover: 0 0% 100%;
    --popover-foreground: 230 15% 15%;

    /* Primary: Deep educational blue */
    --primary: 225 84% 55%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 225 84% 70%;

    /* Secondary: Soft purple for advanced content */
    --secondary: 260 60% 65%;
    --secondary-foreground: 0 0% 100%;

    /* Muted: Light grays for subtle elements */
    --muted: 240 5% 96%;
    --muted-foreground: 230 6% 44%;

    /* Accent: Bright blue for interactive elements */
    --accent: 210 100% 60%;
    --accent-foreground: 0 0% 100%;

    /* Success: Green for correct answers */
    --success: 145 65% 45%;
    --success-foreground: 0 0% 100%;

    /* Warning: Orange for intermediate content */
    --warning: 35 85% 55%;
    --warning-foreground: 0 0% 100%;

    /* Destructive: Red for incorrect answers */
    --destructive: 0 70% 55%;
    --destructive-foreground: 0 0% 100%;

    --border: 240 6% 90%;
    --input: 240 6% 90%;
    --ring: 225 84% 55%;

    --radius: 0.75rem;

    /* Gradients for beautiful backgrounds */
    --gradient-primary: linear-gradient(135deg, hsl(225 84% 55%), hsl(260 60% 65%));
    --gradient-subtle: linear-gradient(180deg, hsl(240 10% 98%), hsl(240 5% 96%));
    --gradient-card: linear-gradient(145deg, hsl(0 0% 100%), hsl(240 5% 98%));
    
    /* Gen Z Nature-inspired gradients */
    --gradient-nature: linear-gradient(135deg, hsl(145 65% 45%), hsl(120 55% 60%));
    --gradient-forest: linear-gradient(135deg, hsl(140 60% 40%), hsl(160 50% 45%));
    --gradient-sage: linear-gradient(135deg, hsl(100 25% 70%), hsl(80 30% 75%));
    --gradient-earth: linear-gradient(135deg, hsl(35 85% 55%), hsl(60 70% 65%));
    --gradient-moss: linear-gradient(135deg, hsl(85 40% 50%), hsl(95 45% 55%));
    --gradient-aurora: linear-gradient(135deg, hsl(280 70% 70%), hsl(320 60% 75%), hsl(160 50% 65%));

    /* Shadows for depth */
    --shadow-soft: 0 4px 20px -2px hsl(225 84% 55% / 0.1);
    --shadow-medium: 0 8px 25px -5px hsl(225 84% 55% / 0.15);
    --shadow-strong: 0 15px 35px -10px hsl(225 84% 55% / 0.2);

    /* Level-specific colors */
    --beginner: 145 65% 50%;
    --intermediate: 35 85% 55%;
    --advanced: 260 60% 55%;

    /* Nature-inspired colors for Gen Z vibes */
    --nature-green: 145 65% 45%;
    --forest-dark: 140 60% 35%;
    --sage-light: 100 25% 75%;
    --earth-warm: 35 85% 55%;
    --moss-soft: 85 40% 55%;
    --leaf-bright: 120 70% 50%;

    /* Animations */
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    --transition-organic: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
  }

  .dark {
    --background: 230 15% 12%;
    --foreground: 240 10% 90%;

    --card: 230 15% 15%;
    --card-foreground: 240 10% 90%;

    --popover: 230 15% 15%;
    --popover-foreground: 240 10% 90%;

    --primary: 225 84% 60%;
    --primary-foreground: 0 0% 100%;
    --primary-glow: 225 84% 75%;

    --secondary: 260 60% 70%;
    --secondary-foreground: 0 0% 100%;

    --muted: 230 12% 18%;
    --muted-foreground: 240 5% 65%;

    --accent: 210 100% 65%;
    --accent-foreground: 0 0% 100%;

    --success: 145 65% 50%;
    --success-foreground: 0 0% 100%;

    --warning: 35 85% 60%;
    --warning-foreground: 0 0% 100%;

    --destructive: 0 70% 60%;
    --destructive-foreground: 0 0% 100%;

    --border: 230 12% 22%;
    --input: 230 12% 22%;
    --ring: 225 84% 60%;

    --gradient-primary: linear-gradient(135deg, hsl(225 84% 60%), hsl(260 60% 70%));
    --gradient-subtle: linear-gradient(180deg, hsl(230 15% 12%), hsl(230 12% 18%));
    --gradient-card: linear-gradient(145deg, hsl(230 15% 15%), hsl(230 12% 18%));

    --shadow-soft: 0 4px 20px -2px hsl(0 0% 0% / 0.3);
    --shadow-medium: 0 8px 25px -5px hsl(0 0% 0% / 0.4);
    --shadow-strong: 0 15px 35px -10px hsl(0 0% 0% / 0.5);

    --beginner: 145 65% 55%;
    --intermediate: 35 85% 60%;
    --advanced: 260 60% 65%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground font-sans antialiased;
  }

  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
  }
  
  ::-webkit-scrollbar-track {
    @apply bg-muted;
  }
  
  ::-webkit-scrollbar-thumb {
    @apply bg-border rounded-full;
  }
  
  ::-webkit-scrollbar-thumb:hover {
    @apply bg-muted-foreground;
  }
}

@layer components {
  /* Card variants */
  .card-gradient {
    background: var(--gradient-card);
    @apply shadow-soft;
  }

  .card-hover {
    @apply transition-all duration-300 hover:shadow-medium hover:-translate-y-1;
  }

  /* Level-specific styling */
  .level-beginner {
    @apply border-l-4 border-green-500 bg-gradient-to-r from-green-50 to-transparent;
  }

  .level-intermediate {
    @apply border-l-4 border-orange-500 bg-gradient-to-r from-orange-50 to-transparent;
  }

  .level-advanced {
    @apply border-l-4 border-purple-500 bg-gradient-to-r from-purple-50 to-transparent;
  }

  /* Animations */
  .expand-enter {
    @apply transition-all duration-300 ease-out;
    max-height: 0;
    opacity: 0;
    transform: translateY(-10px);
  }

  .expand-enter-active {
    max-height: 1000px;
    opacity: 1;
    transform: translateY(0);
  }

  .expand-exit {
    @apply transition-all duration-200 ease-in;
    max-height: 1000px;
    opacity: 1;
    transform: translateY(0);
  }

  .expand-exit-active {
    max-height: 0;
    opacity: 0;
    transform: translateY(-10px);
  }

  /* Math rendering improvements */
  .katex {
    font-size: 1.1em;
  }

  .katex-display {
    @apply my-4;
  }

  /* Enhanced table styling for theory content - Inspired by professional design */
  .theory-table {
    @apply border-collapse bg-white shadow-xl rounded-lg overflow-hidden;
    width: 100%;
    max-width: 900px;
    margin: 2rem auto;
    table-layout: fixed;
    border: 1px solid #e2e8f0;
  }

  .theory-table thead {
    @apply bg-slate-100;
  }

  .theory-table th {
    @apply px-12 py-6 text-left font-semibold text-slate-800;
    border-bottom: 2px solid #cbd5e1;
    border-right: 1px solid #e2e8f0;
    font-size: 1rem;
    letter-spacing: 0.05em;
    word-spacing: 0.1em;
  }

  .theory-table th:last-child {
    border-right: none;
  }

  .theory-table td {
    @apply px-12 py-6 text-left text-slate-700;
    border-bottom: 1px solid #e2e8f0;
    border-right: 1px solid #e2e8f0;
    font-size: 0.95rem;
    vertical-align: middle;
    line-height: 1.8;
    word-spacing: 0.1em;
    letter-spacing: 0.02em;
  }

  .theory-table td:last-child {
    border-right: none;
  }

  .theory-table tbody tr:nth-child(even) {
    @apply bg-slate-50;
  }

  .theory-table tbody tr:hover {
    @apply bg-blue-50;
    transition: background-color 0.2s ease;
  }

  .theory-table tbody tr:last-child td {
    border-bottom: none;
  }

  /* Optimized column widths for different table types */
  .theory-table.cols-2 th:nth-child(1),
  .theory-table.cols-2 td:nth-child(1) {
    width: 35%;
  }

  .theory-table.cols-2 th:nth-child(2),
  .theory-table.cols-2 td:nth-child(2) {
    width: 65%;
  }

  .theory-table.cols-3 th:nth-child(1),
  .theory-table.cols-3 td:nth-child(1) {
    width: 30%;
  }

  .theory-table.cols-3 th:nth-child(2),
  .theory-table.cols-3 td:nth-child(2) {
    width: 35%;
  }

  .theory-table.cols-3 th:nth-child(3),
  .theory-table.cols-3 td:nth-child(3) {
    width: 35%;
  }

  .theory-table.cols-4 th,
  .theory-table.cols-4 td {
    width: 25%;
  }

  /* Special styling for mathematical content */
  .theory-table .katex {
    font-size: 0.9em;
  }

  .theory-table .katex-display {
    margin: 0;
  }

  /* Center tables in content */
  .table-container {
    @apply flex justify-center my-6;
  }

  /* Chatbot message formatting */
  .message-content {
    overflow-wrap: break-word;
    word-wrap: break-word;
    hyphens: auto;
    white-space: normal;
    max-width: 100%;
    overflow: visible !important;
    min-height: auto;
    width: 100%;
    display: block;
  }
  
  /* Ensure message bubbles don't truncate text */
  .message.assistant {
    overflow: visible !important;
    max-height: none !important;
    height: auto !important;
    width: 100% !important;
    max-width: 100% !important;
  }
  
  /* Ensure assistant message containers are full width */
  .message.assistant .message-content {
    width: 100% !important;
    max-width: none !important;
    display: block !important;
    padding: 8px 0 !important;
    margin: 4px 0 !important;
    text-align: left !important;
    direction: ltr !important;
    overflow: hidden !important;
    overflow-x: hidden !important;
  }
  
  /* Remove horizontal scrollbars */
  .message.assistant {
    overflow-x: hidden !important;
    overflow: visible !important;
  }
  
  /* Add more spacing to message bubbles */
  .message.assistant {
    margin: 12px 0 !important;
    padding: 8px !important;
  }
  
  .message-content .math-display {
    display: block;
    text-align: center;
    margin: 4px 0;
    padding: 6px;
    background-color: #f8f9fa;
    border-radius: 6px;
    border: 1px solid #e9ecef;
    overflow-x: hidden;
    overflow: hidden;
  }
  
  .message-content .math-inline {
    background-color: #f8f9fa;
    padding: 2px 4px;
    border-radius: 4px;
    margin: 0 1px;
    border: 1px solid #e9ecef;
    display: inline-block;
    white-space: nowrap;
  }
  
  .message-content strong {
    font-weight: 600;
    color: #1f2937;
  }
  
  .message-content br {
    margin: 2px 0;
  }
  
  .message-content p {
    margin: 4px 0;
    line-height: 1.4;
  }

  /* Matrix display styling for KaTeX rendered matrices */
  .matrix-display {
    display: inline-block;
    margin: 4px 0;
    padding: 8px;
    background-color: #f8f9fa;
    border-radius: 6px;
    text-align: center;
  }
  
  /* KaTeX styling overrides for better matrix appearance */
  .matrix-display .katex {
    font-size: 1.1em;
  }
  
  .matrix-display .katex-display {
    margin: 0.5em 0;
  }

  /* Fix text truncation and display issues */
  .message.assistant .message-content {
    overflow: hidden !important;
    max-height: none !important;
    height: auto !important;
    width: 100% !important;
    max-width: 100% !important;
    display: block !important;
    padding: 8px 0 !important;
    margin: 4px 0 !important;
    text-align: left !important;
    direction: ltr !important;
    word-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    hyphens: auto !important;
    line-height: 1.6 !important;
    box-sizing: border-box !important;
  }

  /* Ensure message bubbles don't overflow boundaries */
  .message.assistant {
    overflow: hidden !important;
    max-height: none !important;
    height: auto !important;
    width: auto !important;
    max-width: 90% !important;
    display: block !important;
    box-sizing: border-box !important;
  }

  /* Fix any text processing issues */
  .message-content * {
    overflow: visible !important;
    max-height: none !important;
    height: auto !important;
  }

  /* Chatbot container constraints */
  .chatbot-container {
    max-width: 450px !important;
    width: 450px !important;
    overflow: hidden !important;
    box-sizing: border-box !important;
  }

  /* Ensure all text elements respect boundaries */
  .message-content p,
  .message-content div,
  .message-content span {
    max-width: 100% !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
  }

  /* Mathematical expression spacing improvements */
  .message-content .math-display {
    margin: 8px 0 !important;
    padding: 12px 16px !important;
    background-color: #f8f9fa !important;
    border: 1px solid #e9ecef !important;
    border-radius: 8px !important;
    text-align: center !important;
    line-height: 1.4 !important;
    display: block !important;
    overflow: visible !important;
  }

  .message-content .math-inline {
    margin: 0 4px !important;
    padding: 3px 6px !important;
    background-color: #f8f9fa !important;
    border: 1px solid #e9ecef !important;
    border-radius: 4px !important;
    display: inline-block !important;
    vertical-align: middle !important;
    line-height: 1.2 !important;
  }

  /* KaTeX spacing improvements */
  .message-content .katex {
    margin: 0 2px !important;
    font-size: 1.1em !important;
    line-height: 1.2 !important;
  }

  .message-content .katex-display {
    margin: 12px 0 !important;
    padding: 8px !important;
    text-align: center !important;
    display: block !important;
  }

  /* Fix clumsy formula rendering */
  .message-content .katex .mfrac {
    display: inline-block !important;
    vertical-align: middle !important;
    margin: 0 2px !important;
  }

  .message-content .katex .mfrac .mfrac-line {
    border-bottom: 1px solid !important;
    margin: 2px 0 !important;
  }

  .message-content .katex .mfrac .mfrac-num,
  .message-content .katex .mfrac .mfrac-den {
    display: block !important;
    text-align: center !important;
  }

  /* Fix superscript and subscript positioning */
  .message-content .katex .msupsub {
    position: relative !important;
    vertical-align: baseline !important;
  }

  .message-content .katex .msup {
    position: absolute !important;
    top: -0.5em !important;
    font-size: 0.75em !important;
  }

  .message-content .katex .msub {
    position: absolute !important;
    bottom: -0.5em !important;
    font-size: 0.75em !important;
  }

  /* Fix root symbols */
  .message-content .katex .sqrt {
    display: inline-block !important;
    vertical-align: middle !important;
  }

  .message-content .katex .sqrt .sqrt-sign {
    position: relative !important;
  }

  /* Add spacing around mathematical operators */
  .message-content .katex .mord + .mbin,
  .message-content .katex .mbin + .mord,
  .message-content .katex .mrel + .mord,
  .message-content .katex .mord + .mrel {
    margin: 0 4px !important;
  }

  /* Improve spacing for fractions */
  .message-content .katex .frac-line {
    margin: 2px 0 !important;
  }

  /* Add padding around mathematical expressions */
  .message-content .katex .base {
    margin: 0 1px !important;
  }

  /* Improve overall text spacing in messages */
  .message-content {
    letter-spacing: 0.025em !important;
    word-spacing: 0.1em !important;
  }

  /* Add spacing around mathematical symbols */
  .message-content .katex .mbin {
    margin: 0 3px !important;
  }

  .message-content .katex .mrel {
    margin: 0 3px !important;
  }

  /* Improve fraction spacing */
  .message-content .katex .frac {
    margin: 4px 0 !important;
  }

  /* Better spacing for superscripts and subscripts */
  .message-content .katex .msupsub {
    margin: 0 2px !important;
  }

  /* Add breathing room around mathematical expressions */
  .message-content .math-display,
  .message-content .math-inline {
    margin: 4px 0 !important;
  }

  /* Final polish for mathematical rendering */
  .message-content .katex .base {
    margin: 0 1px !important;
    padding: 0 1px !important;
  }

  /* Ensure proper alignment for all mathematical elements */
  .message-content .katex .mrow {
    display: inline-block !important;
    vertical-align: middle !important;
  }

  /* Fix any remaining alignment issues */
  .message-content .katex .mrel {
    margin: 0 4px !important;
    vertical-align: middle !important;
  }

  .message-content .katex .mbin {
    margin: 0 4px !important;
    vertical-align: middle !important;
  }

  /* Ensure fractions are properly centered */
  .message-content .katex .mfrac > .mfrac-num,
  .message-content .katex .mfrac > .mfrac-den {
    display: block !important;
    text-align: center !important;
    width: 100% !important;
  }

  /* Fix square root rendering */
  .message-content .katex .sqrt > .vlist-t {
    display: inline-block !important;
    vertical-align: middle !important;
  }

  /* Fix formula overflow - ensure all mathematical content stays within bounds */
  .message-content .math-display {
    max-width: 100% !important;
    width: 100% !important;
    overflow-x: auto !important;
    overflow-y: visible !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    box-sizing: border-box !important;
    font-size: 1.1em !important;
    line-height: 1.4 !important;
    display: block !important;
  }

  .message-content .math-inline {
    max-width: 100% !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    display: inline-block !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
    font-size: 1.05em !important;
    line-height: 1.3 !important;
  }

  /* Enhanced number and symbol spacing */
  .message-content .katex .mord {
    margin: 0 1px !important;
    padding: 0 1px !important;
  }

  /* Better spacing for numbers specifically */
  .message-content .katex .mord.mord-number {
    margin: 0 2px !important;
    padding: 0 1px !important;
    font-weight: 500 !important;
  }

  /* Improve spacing around operators */
  .message-content .katex .mbin,
  .message-content .katex .mrel {
    margin: 0 4px !important;
    padding: 0 2px !important;
  }

  /* Ensure KaTeX elements don't overflow */
  .message-content .katex {
    max-width: 100% !important;
    overflow-x: auto !important;
    overflow-y: visible !important;
    word-wrap: break-word !important;
    white-space: normal !important;
  }

  .message-content .katex-display {
    max-width: 100% !important;
    overflow-x: auto !important;
    overflow-y: visible !important;
    word-wrap: break-word !important;
    white-space: normal !important;
    margin: 8px 0 !important;
    padding: 8px !important;
  }

  /* Chatbot container overflow protection */
  .chatbot-container {
    max-width: 450px !important;
    width: 450px !important;
    overflow: hidden !important;
    box-sizing: border-box !important;
    height: calc(100vh - 4rem) !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Scroll area improvements */
  .chatbot-container [data-radix-scroll-area-viewport] {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    scrollbar-width: thin !important;
    scrollbar-color: #cbd5e0 #f7fafc !important;
  }

  .chatbot-container [data-radix-scroll-area-viewport]::-webkit-scrollbar {
    width: 6px !important;
  }

  .chatbot-container [data-radix-scroll-area-viewport]::-webkit-scrollbar-track {
    background: #f7fafc !important;
    border-radius: 3px !important;
  }

  .chatbot-container [data-radix-scroll-area-viewport]::-webkit-scrollbar-thumb {
    background: #cbd5e0 !important;
    border-radius: 3px !important;
  }

  .chatbot-container [data-radix-scroll-area-viewport]::-webkit-scrollbar-thumb:hover {
    background: #a0aec0 !important;
  }

  .message.assistant {
    max-width: 100% !important;
    width: 100% !important;
    overflow: hidden !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    box-sizing: border-box !important;
  }

  .message-content {
    max-width: 100% !important;
    width: 100% !important;
    overflow: hidden !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    box-sizing: border-box !important;
  }

  .message-content * {
    max-width: 100% !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    word-break: break-word !important;
    white-space: normal !important;
    box-sizing: border-box !important;
  }

  /* Professional Math Block Styling */
  .math-block {
    overflow-x: auto;
    white-space: nowrap;
    max-width: 100%;
    padding: 12px 16px;
    margin: 16px 0;
    background: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    font-family: 'Computer Modern', 'Times New Roman', serif;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    text-align: center;
  }

  /* Inline Math Styling */
  .math-inline {
    font-family: 'Computer Modern', 'Times New Roman', serif;
    font-style: normal;
    background: #f0f8ff;
    padding: 2px 4px;
    border-radius: 3px;
    border: 1px solid #ddeeff;
  }

  /* Set Notation Styling */
  .set-notation {
    background: #f0f8ff;
    padding: 4px 8px;
    border-radius: 4px;
    font-family: monospace;
    font-size: 0.95em;
    border: 1px solid #ddeeff;
    display: inline-block;
    margin: 2px;
  }

  /* Response Container */
  .response-content {
    max-width: 100%;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.6;
  }

  /* MathJax Styling */
  .MathJax {
    font-size: 1.1em !important;
  }

  .MathJax_Display {
    margin: 1em 0 !important;
    text-align: center !important;
  }

  /* Mobile Responsiveness */
  @media (max-width: 768px) {
    .math-block {
      font-size: 0.9em;
      padding: 8px 12px;
      margin: 12px 0;
    }
    
    .set-notation {
      font-size: 0.85em;
      padding: 2px 6px;
    }

    .MathJax {
      font-size: 1em !important;
    }
  }

  /* Ensure KaTeX renders properly */
  .math-block .katex {
    white-space: nowrap !important;
    display: inline-block !important;
    line-height: 1.2 !important;
  }

  .math-block .katex-display {
    margin: 0 !important;
    text-align: center !important;
    white-space: nowrap !important;
  }

  /* Math inline styling */
  .math-inline {
    margin: 0 2px !important;
    padding: 2px 4px !important;
    background: #f8f9fa !important;
    border: 1px solid #e9ecef !important;
    border-radius: 4px !important;
    display: inline-block !important;
    vertical-align: middle !important;
    box-sizing: border-box !important;
    line-height: 1.2 !important;
  }

  /* Ensure inline KaTeX renders properly */
  .math-inline .katex {
    white-space: nowrap !important;
    display: inline-block !important;
    line-height: 1.2 !important;
  }

  /* Custom scrollbar for math blocks */
  .math-block::-webkit-scrollbar {
    height: 6px !important;
  }

  .math-block::-webkit-scrollbar-track {
    background: #f7fafc !important;
    border-radius: 3px !important;
  }

  .math-block::-webkit-scrollbar-thumb {
    background: #cbd5e0 !important;
    border-radius: 3px !important;
  }

  .math-block::-webkit-scrollbar-thumb:hover {
    background: #a0aec0 !important;
  }
}
